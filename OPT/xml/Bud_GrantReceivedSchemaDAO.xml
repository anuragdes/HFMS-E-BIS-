<?xml version="1.0" encoding="UTF-8"?>
<tns:Transaction MODULE_NAME="BUDGET" PROCESS_NAME="Grant Received Form" xmlns:tns="http://www.example.org/transactionSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.example.org/transactionSchema transactionSchema.xsd ">


 <OPR ID="1" NAME="INSERT" BLOCK_SIZE="1" QRY_TOT_SIZE="1" TRN_MGMT="Y">
  <BLOCK ID="1" QRY_SIZE="1" ROWS_INS="S" MANDATORY="Y">
	<QRY ID="1" COL_SIZE="15">
	    INSERT INTO ACTBUD_GRANT_REC_TRN(STR_LETTER_NO,STR_BUDGET_YEAR,DT_LETTER_DATE,STR_SOURCE_OF_GRANT,STR_GRANT_TYPE_ID,STR_DEMAND_NO,STR_BUD_TYPE_CODE,STR_EVENT_TYPE,NUM_SANCTIONED_AMOUNT,STR_SANCTIONED_BY,GDT_ENTRY_DATE,GNUM_ISVALID,GNUM_SEAT_ID,NUM_GRANT_ID,GNUM_HOSPITAL_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
	</QRY>
  </BLOCK>
 </OPR>
  
   
   <OPR ID="3" NAME="INSERT FOR UPDATE" BLOCK_SIZE="2" QRY_TOT_SIZE="2" TRN_MGMT="Y">
   
   <BLOCK ID="1" QRY_SIZE="1" ROWS_INS="M" MANDATORY="Y">
	<QRY ID="1" COL_SIZE="2">
	 INSERT INTO ACTBUD_ALOG_GRANT_REC_TRN(STR_BUDGET_YEAR,STR_LETTER_NO,DT_LETTER_DATE,STR_SOURCE_OF_GRANT,STR_GRANT_TYPE_ID,STR_DEMAND_NO,STR_BUD_TYPE_CODE,STR_EVENT_TYPE ,NUM_SANCTIONED_AMOUNT,STR_SANCTIONED_BY,GDT_LSTMOD_DATE ,GNUM_LSTMOD_SEATID ,GDT_ENTRY_DATE,GNUM_ISVALID,GNUM_SEAT_ID,NUM_GRANT_ID,GNUM_HOSPITAL_CODE,NUM_MODIFY_SL_NO ) (SELECT T.STR_BUDGET_YEAR,T.STR_LETTER_NO,T.DT_LETTER_DATE,T.STR_SOURCE_OF_GRANT,T.STR_GRANT_TYPE_ID,T.STR_DEMAND_NO,T.STR_BUD_TYPE_CODE,T.STR_EVENT_TYPE ,T.NUM_SANCTIONED_AMOUNT,T.STR_SANCTIONED_BY,T.GDT_LSTMOD_DATE ,T.GNUM_LSTMOD_SEATID ,T.GDT_ENTRY_DATE,T.GNUM_ISVALID,T.GNUM_SEAT_ID,T.NUM_GRANT_ID,T.GNUM_HOSPITAL_CODE,(select nvl(max(A.NUM_MODIFY_SL_NO),0)+1 from ACTBUD_ALOG_GRANT_REC_TRN A where A.NUM_GRANT_ID=T.NUM_GRANT_ID and A.GNUM_HOSPITAL_CODE=T.GNUM_HOSPITAL_CODE) FROM ACTBUD_GRANT_REC_TRN T WHERE T.NUM_GRANT_ID=? AND T.GNUM_HOSPITAL_CODE=?)
	</QRY>
   </BLOCK>
   
  <BLOCK ID="2" QRY_SIZE="1" ROWS_INS="S" MANDATORY="Y">
	<QRY ID="1" COL_SIZE="14">
	 UPDATE ACTBUD_GRANT_REC_TRN SET STR_BUDGET_YEAR=?,DT_LETTER_DATE=TO_DATE(?,'DD-MON-YYYY'),STR_SOURCE_OF_GRANT=?,STR_GRANT_TYPE_ID=?,STR_DEMAND_NO=?,STR_BUD_TYPE_CODE=?,STR_EVENT_TYPE=?,NUM_SANCTIONED_AMOUNT=?,STR_SANCTIONED_BY=?,GDT_LSTMOD_DATE=?,GNUM_LSTMOD_SEATID=? WHERE STR_LETTER_NO=? and NUM_GRANT_ID=? and GNUM_HOSPITAL_CODE=?
	</QRY>
  </BLOCK>
  </OPR>
     
   <OPR ID="4" NAME="INSERT FOR UPDATE" BLOCK_SIZE="3" QRY_TOT_SIZE="3" TRN_MGMT="Y">
   
   <BLOCK ID="1" QRY_SIZE="1" ROWS_INS="M" MANDATORY="Y">
	<QRY ID="1" COL_SIZE="2">
	 INSERT INTO ACTBUD_ALOG_GRANT_REC_DTL(NUM_GRANT_ID,NUM_AMOUNT,STR_IN_FAVOUR_OF,STR_BANK_ID,STR_BRANCH_ID,STR_INSTRUMENT_NAME,DT_INSTRUMENT_DATE,GDT_ENTRY_DATE ,GNUM_ISVALID,GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,STR_MODE_OF_RECEIVING,STR_RELEASE_SL_NO,NUM_MODIFY_SL_NO) (SELECT T.NUM_GRANT_ID,T.NUM_AMOUNT,T.STR_IN_FAVOUR_OF,T.STR_BANK_ID,T.STR_BRANCH_ID,T.STR_INSTRUMENT_NAME,T.DT_INSTRUMENT_DATE,T.GDT_ENTRY_DATE ,T.GNUM_ISVALID,T.GNUM_SEAT_ID,T.GNUM_HOSPITAL_CODE,T.STR_MODE_OF_RECEIVING,T.STR_RELEASE_SL_NO,(select nvl(max(A.NUM_MODIFY_SL_NO),0)+1 from ACTBUD_ALOG_GRANT_REC_DTL A where A.NUM_GRANT_ID=T.NUM_GRANT_ID and A.GNUM_HOSPITAL_CODE=T.GNUM_HOSPITAL_CODE) FROM ACTBUD_GRANT_REC_DTL T WHERE T.NUM_GRANT_ID=? AND T.GNUM_HOSPITAL_CODE=?)
	</QRY>
   </BLOCK>
   
   <BLOCK ID="2" QRY_SIZE="1" ROWS_INS="M" MANDATORY="Y">
	<QRY ID="1" COL_SIZE="2">
	 DELETE FROM  ACTBUD_GRANT_REC_DTL T WHERE T.NUM_GRANT_ID=? and T.GNUM_HOSPITAL_CODE=?
	</QRY>
   </BLOCK>
 	
  <BLOCK ID="3" QRY_SIZE="1" ROWS_INS="M" MANDATORY="Y">
	<QRY ID="1" COL_SIZE="13">
	INSERT INTO ACTBUD_GRANT_REC_DTL (STR_MODE_OF_RECEIVING,STR_RELEASE_SL_NO,NUM_AMOUNT,STR_IN_FAVOUR_OF,STR_BANK_ID,STR_BRANCH_ID,STR_INSTRUMENT_NAME,DT_INSTRUMENT_DATE,GDT_ENTRY_DATE,GNUM_ISVALID,GNUM_SEAT_ID,NUM_GRANT_ID,GNUM_HOSPITAL_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)
	</QRY>
   </BLOCK>

  </OPR>


<OPR ID="5" NAME="DELETE" BLOCK_SIZE="2" QRY_TOT_SIZE="2" TRN_MGMT="Y">
  <BLOCK ID="1" QRY_SIZE="1" ROWS_INS="S" MANDATORY="Y">
	<QRY ID="1" COL_SIZE="2">
		 UPDATE ACTBUD_GRANT_REC_TRN SET GNUM_ISVALID=0 WHERE NUM_GRANT_ID=? and GNUM_HOSPITAL_CODE=?
	</QRY>
   </BLOCK>
   
   <BLOCK ID="2" QRY_SIZE="1" ROWS_INS="M" MANDATORY="Y">
	<QRY ID="1" COL_SIZE="2">
	 	UPDATE ACTBUD_GRANT_REC_DTL SET GNUM_ISVALID=0 WHERE NUM_GRANT_ID=? and GNUM_HOSPITAL_CODE=?
	</QRY>
   </BLOCK>
</OPR>
   
   
   
</tns:Transaction>